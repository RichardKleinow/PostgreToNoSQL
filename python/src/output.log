2022-11-10 15:41:56,923 [MainProcess] [root] [ERROR] connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2022-11-10 15:41:56,924 [MainProcess] [root] [ERROR] connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

2022-11-10 15:41:56,924 [MainProcess] [root] [ERROR] Error on line 32
2022-11-10 15:42:01,955 [MainProcess] [root] [ERROR] <class 'pymongo.errors.ServerSelectionTimeoutError'>
2022-11-10 15:42:01,956 [MainProcess] [root] [ERROR] localhost:27017: [WinError 10061] Es konnte keine Verbindung hergestellt werden, da der Zielcomputer die Verbindung verweigerte, Timeout: 5.0s, Topology Description: <TopologyDescription id: 636d0db42df013604a6cdef2, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [WinError 10061] Es konnte keine Verbindung hergestellt werden, da der Zielcomputer die Verbindung verweigerte')>]>
2022-11-10 15:42:01,956 [MainProcess] [root] [ERROR] Error on line 351
2022-11-10 15:42:01,957 [MainProcess] [root] [INFO] Transformation of 0 tables successful
2022-11-10 15:42:01,957 [MainProcess] [root] [INFO] ######### CREATE START ############################
2022-11-10 15:42:01,957 [MainProcess] [root] [INFO] Starting to insert 0 json elements into new database.
2022-11-10 15:42:01,957 [MainProcess] [root] [INFO] Command used to insert: collection.insert_many(dicttables.get(table))
2022-11-10 15:42:01,958 [MainProcess] [root] [INFO] 0 tables were successfully inserted as collections.
2022-11-10 15:42:01,958 [MainProcess] [root] [INFO] ######### READ START ############################
2022-11-10 15:42:01,958 [MainProcess] [root] [INFO] --------Number of available films--------
2022-11-10 15:42:01,958 [MainProcess] [root] [INFO] Pipeline used: [{'$count': 'film'}]
2022-11-10 15:42:01,958 [MainProcess] [root] [INFO] Pipeline used on Collection: film
2022-11-10 15:42:01,959 [MainProcess] [root] [ERROR] Unable to run query.
2022-11-10 15:42:01,959 [MainProcess] [root] [ERROR] 'MDB' object has no attribute 'db'
2022-11-10 15:42:01,959 [MainProcess] [root] [ERROR] Error on line 400
2022-11-10 15:42:01,959 [MainProcess] [root] [INFO] 
2022-11-10 15:42:01,960 [MainProcess] [root] [INFO] --------Number of films per location--------
2022-11-10 15:42:01,960 [MainProcess] [root] [INFO] Pipeline used: [{'$group': {'_id': '$store_id', 'count': {'$sum': 1}}}, {'$project': {'_id': 0, 'store_id': '$_id', 'count': 1}}]
2022-11-10 15:42:01,960 [MainProcess] [root] [INFO] Pipeline used on Collection: inventory
2022-11-10 15:42:01,960 [MainProcess] [root] [ERROR] Unable to run query.
2022-11-10 15:42:01,960 [MainProcess] [root] [ERROR] 'MDB' object has no attribute 'db'
2022-11-10 15:42:01,960 [MainProcess] [root] [ERROR] Error on line 400
2022-11-10 15:42:01,960 [MainProcess] [root] [INFO] 
2022-11-10 15:42:01,960 [MainProcess] [root] [INFO] --------Full name, 10 most used actors, sorted descending --------
2022-11-10 15:42:01,961 [MainProcess] [root] [INFO] Pipeline used: [{'$group': {'_id': '$actor_id', 'count': {'$sum': 1}, 'actor_id': {'$first': '$actor_id'}}}, {'$sort': {'count': -1}}, {'$limit': 10}, {'$lookup': {'from': 'actor', 'localField': 'actor_id', 'foreignField': 'actor_id', 'as': 'actor'}}, {'$unwind': {'path': '$actor', 'preserveNullAndEmptyArrays': True}}, {'$addFields': {'fullName': {'$concat': ['$actor.first_name', ' ', '$actor.last_name']}}}, {'$project': {'_id': 0, 'name': '$fullName', 'count': '$count'}}]
2022-11-10 15:42:01,961 [MainProcess] [root] [INFO] Pipeline used on Collection: film_actor
2022-11-10 15:42:01,961 [MainProcess] [root] [ERROR] Unable to run query.
2022-11-10 15:42:01,961 [MainProcess] [root] [ERROR] 'MDB' object has no attribute 'db'
2022-11-10 15:42:01,962 [MainProcess] [root] [ERROR] Error on line 400
2022-11-10 15:42:01,962 [MainProcess] [root] [INFO] 
2022-11-10 15:42:01,962 [MainProcess] [root] [INFO] --------Revenue per Employees --------
2022-11-10 15:42:01,962 [MainProcess] [root] [INFO] Pipeline used: [{'$group': {'_id': '$staff_id', 'count': {'$sum': '$amount'}, 'staff_id': {'$first': '$staff_id'}}}, {'$lookup': {'from': 'staff', 'localField': 'staff_id', 'foreignField': 'staff_id', 'as': 'staff'}}, {'$unwind': {'path': '$staff', 'preserveNullAndEmptyArrays': True}}, {'$addFields': {'fullName': {'$concat': ['$staff.first_name', ' ', '$staff.last_name']}}}, {'$project': {'_id': 0, 'name': '$fullName', 'revenue': {'$round': ['$count', 2]}, 'staff_id': 1}}]
2022-11-10 15:42:01,962 [MainProcess] [root] [INFO] Pipeline used on Collection: payment
2022-11-10 15:42:01,962 [MainProcess] [root] [ERROR] Unable to run query.
2022-11-10 15:42:01,962 [MainProcess] [root] [ERROR] 'MDB' object has no attribute 'db'
2022-11-10 15:42:01,962 [MainProcess] [root] [ERROR] Error on line 400
2022-11-10 15:42:01,963 [MainProcess] [root] [INFO] 
2022-11-10 15:42:01,963 [MainProcess] [root] [INFO] --------customer IDs, 10 most rentals --------
2022-11-10 15:42:01,963 [MainProcess] [root] [INFO] Pipeline used: [{'$group': {'_id': '$customer_id', 'count': {'$sum': 1}, 'customer_id': {'$first': '$customer_id'}}}, {'$sort': {'count': -1}}, {'$limit': 10}, {'$project': {'_id': 0, 'customer_id': 1, 'count': '$count'}}]
2022-11-10 15:42:01,963 [MainProcess] [root] [INFO] Pipeline used on Collection: rental
2022-11-10 15:42:01,963 [MainProcess] [root] [ERROR] Unable to run query.
2022-11-10 15:42:01,963 [MainProcess] [root] [ERROR] 'MDB' object has no attribute 'db'
2022-11-10 15:42:01,963 [MainProcess] [root] [ERROR] Error on line 400
2022-11-10 15:42:01,963 [MainProcess] [root] [INFO] 
2022-11-10 15:42:01,963 [MainProcess] [root] [INFO] --------Fullname, office location, 10 customer, most money spend--------
2022-11-10 15:42:01,963 [MainProcess] [root] [INFO] Pipeline used: [{'$group': {'_id': '$customer_id', 'count': {'$sum': '$amount'}, 'customer_id': {'$first': '$customer_id'}}}, {'$sort': {'count': -1}}, {'$limit': 10}, {'$lookup': {'from': 'customer', 'localField': 'customer_id', 'foreignField': 'customer_id', 'as': 'customer'}}, {'$unwind': {'path': '$customer', 'preserveNullAndEmptyArrays': True}}, {'$lookup': {'from': 'customer', 'localField': 'customer_id', 'foreignField': 'customer_id', 'as': 'customer'}}, {'$unwind': {'path': '$customer', 'preserveNullAndEmptyArrays': True}}, {'$lookup': {'from': 'store', 'localField': 'customer.store_id', 'foreignField': 'store_id', 'as': 'store'}}, {'$unwind': {'path': '$store', 'preserveNullAndEmptyArrays': True}}, {'$lookup': {'from': 'address', 'localField': 'store.address_id', 'foreignField': 'address_id', 'as': 'address'}}, {'$unwind': {'path': '$address', 'preserveNullAndEmptyArrays': True}}, {'$lookup': {'from': 'city', 'localField': 'address.city_id', 'foreignField': 'city_id', 'as': 'city'}}, {'$unwind': {'path': '$city', 'preserveNullAndEmptyArrays': True}}, {'$addFields': {'fullName': {'$concat': ['$customer.first_name', ' ', '$customer.last_name']}, 'officeLocation': {'$concat': [{'$cond': {'if': {'$gte': ['$address.address', '']}, 'then': '$address.address', 'else': '$address.address2'}}, ' ,', '$address.postal_code', ' ', '$city.city']}}}, {'$project': {'_id': 0, 'name': '$fullName', 'revenue': {'$round': ['$count', 2]}, 'office location': '$officeLocation'}}]
2022-11-10 15:42:01,964 [MainProcess] [root] [INFO] Pipeline used on Collection: payment
2022-11-10 15:42:01,964 [MainProcess] [root] [ERROR] Unable to run query.
2022-11-10 15:42:01,964 [MainProcess] [root] [ERROR] 'MDB' object has no attribute 'db'
2022-11-10 15:42:01,964 [MainProcess] [root] [ERROR] Error on line 400
2022-11-10 15:42:01,964 [MainProcess] [root] [INFO] 
2022-11-10 15:42:01,964 [MainProcess] [root] [INFO] --------titles 10 most viewed films, sorted descending--------
2022-11-10 15:42:01,964 [MainProcess] [root] [INFO] Pipeline used: [{'$group': {'_id': '$inventory_id', 'count': {'$sum': 1}, 'inventory_id': {'$first': '$inventory_id'}}}, {'$sort': {'count': -1}}, {'$limit': 10}, {'$lookup': {'from': 'inventory', 'localField': 'inventory_id', 'foreignField': 'inventory_id', 'as': 'inventory'}}, {'$unwind': {'path': '$inventory', 'preserveNullAndEmptyArrays': True}}, {'$lookup': {'from': 'film', 'localField': 'inventory.film_id', 'foreignField': 'film_id', 'as': 'film'}}, {'$unwind': {'path': '$film', 'preserveNullAndEmptyArrays': True}}, {'$project': {'_id': 0, 'title': '$film.title', 'view numbers': '$count'}}]
2022-11-10 15:42:01,965 [MainProcess] [root] [INFO] Pipeline used on Collection: rental
2022-11-10 15:42:01,965 [MainProcess] [root] [ERROR] Unable to run query.
2022-11-10 15:42:01,965 [MainProcess] [root] [ERROR] 'MDB' object has no attribute 'db'
2022-11-10 15:42:01,965 [MainProcess] [root] [ERROR] Error on line 400
2022-11-10 15:42:01,965 [MainProcess] [root] [INFO] 
2022-11-10 15:42:01,965 [MainProcess] [root] [INFO] --------Top 3 film categorys--------
2022-11-10 15:42:01,965 [MainProcess] [root] [INFO] Pipeline used: [{'$lookup': {'from': 'inventory', 'localField': 'inventory_id', 'foreignField': 'inventory_id', 'as': 'inventory'}}, {'$lookup': {'from': 'film_category', 'localField': 'inventory.film_id', 'foreignField': 'film_id', 'as': 'film_category'}}, {'$lookup': {'from': 'category', 'localField': 'film_category.category_id', 'foreignField': 'category_id', 'as': 'category'}}, {'$unwind': {'path': '$category', 'preserveNullAndEmptyArrays': True}}, {'$group': {'_id': '$film_category.category_id', 'count': {'$sum': 1}, 'name': {'$first': '$category.name'}}}, {'$sort': {'count': -1}}, {'$limit': 3}, {'$project': {'_id': 0, 'category': '$name', 'view numbers': '$count'}}]
2022-11-10 15:42:01,965 [MainProcess] [root] [INFO] Pipeline used on Collection: rental
2022-11-10 15:42:01,965 [MainProcess] [root] [ERROR] Unable to run query.
2022-11-10 15:42:01,965 [MainProcess] [root] [ERROR] 'MDB' object has no attribute 'db'
2022-11-10 15:42:01,965 [MainProcess] [root] [ERROR] Error on line 400
2022-11-10 15:42:01,965 [MainProcess] [root] [INFO] 
2022-11-10 15:42:01,965 [MainProcess] [root] [INFO] --------Create View customer_list--------
2022-11-10 15:42:01,966 [MainProcess] [root] [INFO] Pipeline used: [{'$lookup': {'from': 'address', 'localField': 'address_id', 'foreignField': 'address_id', 'as': 'address'}}, {'$unwind': {'path': '$address', 'preserveNullAndEmptyArrays': True}}, {'$lookup': {'from': 'city', 'localField': 'address.city_id', 'foreignField': 'city_id', 'as': 'city'}}, {'$unwind': {'path': '$city', 'preserveNullAndEmptyArrays': True}}, {'$lookup': {'from': 'country', 'localField': 'city.country_id', 'foreignField': 'country_id', 'as': 'country'}}, {'$unwind': {'path': '$country', 'preserveNullAndEmptyArrays': True}}, {'$addFields': {'fullName': {'$concat': ['$first_name', ' ', '$last_name']}, 'notes': {'$cond': {'if': '$activebool', 'then': 'active', 'else': ''}}}}, {'$project': {'_id': 1, 'customer_id': 1, 'name': '$fullName', 'address': '$address.address', 'zip code': '$address.postal_code', 'phone': '$address.phone', 'city': '$city.city', 'country': '$country.country', 'notes': '$notes', 'sid': '$store_id'}}]
2022-11-10 15:42:01,966 [MainProcess] [root] [INFO] View on Collection: customer
2022-11-10 15:42:01,966 [MainProcess] [root] [ERROR] Unable to Create customer_list view.
2022-11-10 15:42:01,966 [MainProcess] [root] [ERROR] 'MDB' object has no attribute 'db'
2022-11-10 15:42:01,966 [MainProcess] [root] [ERROR] Error on line 385
2022-11-10 15:42:01,966 [MainProcess] [root] [INFO] View successfully created.
2022-11-10 15:42:01,966 [MainProcess] [root] [INFO] 
2022-11-10 15:42:01,966 [MainProcess] [root] [INFO] ######### READ END ############################
2022-11-10 15:42:01,966 [MainProcess] [root] [INFO] ######### UPDATE START ############################
